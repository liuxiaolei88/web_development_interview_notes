# 中信达实习复盘

## 简历描述

- **项目背景：**开发一个输入”免税“相关的关键词，实现自动爬取贴吧、微博发帖，导出成Excel的工具。
- **使用技术：**Vue2.0+ElementUI+Xpath+Scrapy+Flask
- **搜索提示：**封装搜索组件，预先设定常用搜索关键词，用户搜索时可以出现关键词提示，高频关键词按钮可以一键搜索。
- **按钮优化：**使用xlsx插件实现数据导出功能，对导出按钮进行防抖优化，解决用户使用过程多次点击导致多次下载excel表格。
- **接口封装：**使用flask-cors解决跨域问题，为爬虫程序封装请求接口，为前端页面返回JSON数据。
- **项目成果：**代替手工采集数据，优化每日平均工作时间2小时，采集数据1000余条，用于录入海南省公安厅社管平台子系统。

## 项目难点：

### 1 如何实现导出？导出的优化

项目的一个主要需求是需要将爬虫爬取的数据输出Excel表格交给专门负责数据审核的同事。经过查阅资料，我选用了xlsx的npm包。这样只需要将json转成数组就可以存储进excel表格，通过writeFile直接就可以得到表格。但在使用的过程中会发生数据导出的延迟，但用户并不清楚是否成功点击成功，等数据返回以后已经生成了好几个excel表格。针对这个情况我使用了防抖进行优化，让用户的多次点击后只有最后一次生效。每次点击都触发计时器，当2s内重复触碰则会让计时器清0。这样就可以实现用户多次点击导出按钮，但只导出一次的效果。

![img](https://pic4.zhimg.com/v2-ab386652886e6d4c1601a9b984c11813_r.jpg)

​			https://zhuanlan.zhihu.com/p/268835049

### 2 如何实现搜索提示？

项目的主要功能是输入免税相关的提示词进行爬取，对于贴吧是对贴吧名作为关键词爬取对象。例如海南免税店、海口免税店、三亚免税店等。而对于微博则是对关键词直接爬取。但直接搜索免税关键词则不能很好的检索出代购消息。需要搜索例如“离岛滴滴”等话术。为了方便大家使用，我将高频的关键词实现成了按钮，可以一键点击按此关键词检索。同时，在检索框输入关键词的时候，会出现相关的关键词，例如输入免税店，则会出现海口免税店的补全提示，帮助用户更好的搜索到内容。

```js
computed:{
					显示的变量(){
						return this.高频关键词数组.filter((item)=>{
							return item.关键词.indexOf('输入') !== -1
						})
					}
				}
			})
```

### 3 如何实现跨域的？

在后端有两种方式，一种是全局方式，将所有接口都支持跨域请求。

```python
CORS(app, supports_credentials=True)
```

一种是只对某几个接口

```python
@app.route('/')
@cross_origin(supports_credentials=True)
```

在里面可以设置method 、origin等

https://zhuanlan.zhihu.com/p/274769003